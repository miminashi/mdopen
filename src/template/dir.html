{% extends "base.html" %}
{% set title = dir_path %}
{% block title %}Directory {{ dir_path }}{% endblock %}

{% block head %}
{{ super() }}
<style>
.dir-listing {
    max-width: 980px;
    margin: 0 auto;
    padding: 20px 45px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif;
}
.dir-listing h1 {
    font-size: 1.5em;
    margin-bottom: 16px;
}
.breadcrumb {
    font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
}
.breadcrumb a {
    text-decoration: none;
    color: #0969da;
}
.breadcrumb a:hover {
    text-decoration: underline;
}
.breadcrumb .separator {
    color: #656d76;
    margin: 0 2px;
}
.file-table th a {
    text-decoration: none;
    color: inherit;
    display: flex;
    align-items: center;
    gap: 4px;
}
.file-table th a:hover {
    color: #0969da;
}
.sort-arrow {
    font-size: 10px;
    opacity: 0.3;
}
.sort-arrow.active {
    opacity: 1;
}
.file-table {
    width: 100%;
    border-collapse: collapse;
}
.file-table th, .file-table td {
    text-align: left;
    padding: 8px 12px;
    border-bottom: 1px solid #d0d7de;
}
.file-table th {
    font-weight: 600;
    background-color: #f6f8fa;
}
.file-table td.name {
    word-break: break-all;
}
.file-table td.modified {
    white-space: nowrap;
    color: #656d76;
    font-size: 14px;
}
.file-table a {
    text-decoration: none;
    color: #0969da;
}
.file-table a:hover {
    text-decoration: underline;
}
.dir-icon::before {
    content: "üìÅ ";
}
.file-icon::before {
    content: "üìÑ ";
}
@media (prefers-color-scheme: dark) {
    .dir-listing {
        color: #c9d1d9;
    }
    .breadcrumb a {
        color: #58a6ff;
    }
    .breadcrumb .separator {
        color: #8b949e;
    }
    .file-table th {
        background-color: #161b22;
    }
    .file-table th, .file-table td {
        border-bottom-color: #30363d;
    }
    .file-table td.modified {
        color: #8b949e;
    }
    .file-table a {
        color: #58a6ff;
    }
    .file-table th a:hover {
        color: #58a6ff;
    }
}
</style>
{% endblock %}

{% block body %}
<div class="dir-listing">
    <h1>Directory</h1>
    <p><span class="breadcrumb"><a href="/">{{root_name}}</a>{% for crumb in breadcrumbs %}<span class="separator">/</span><a href="/{{crumb.path}}">{{crumb.name}}</a>{% endfor %}</span></p>
    <table class="file-table">
        <thead>
            <tr>
                <th>
                    <a href="?sort={{name_next_sort}}">
                        Name
                        <span class="sort-arrow {% if current_sort == 'name' %}active{% endif %}">{% if current_sort == 'name' %}‚ñ≤{% elif current_sort == 'name_desc' %}‚ñº{% else %}‚ñ≤{% endif %}</span>
                    </a>
                </th>
                <th>
                    <a href="?sort={{time_next_sort}}">
                        Modified
                        <span class="sort-arrow {% if current_sort == 'time' or current_sort == 'time_asc' %}active{% endif %}">{% if current_sort == 'time_asc' %}‚ñ≤{% elif current_sort == 'time' %}‚ñº{% else %}‚ñº{% endif %}</span>
                    </a>
                </th>
            </tr>
        </thead>
        <tbody>
            {% for file in files %}
            <tr>
                <td class="name"><span class="{% if file.is_dir %}dir-icon{% else %}file-icon{% endif %}"></span><a href="/{{file.path}}">{{ file.name }}</a></td>
                <td class="modified">{{ file.modified }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">empty...</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block extra %}
{% endblock %}
